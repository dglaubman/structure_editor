// Generated by CoffeeScript 1.6.3
(function() {
  var comm, currentGraph, log, messageHandler, widgets,
    _this = this;

  log = new Log(d3.select("#console"));

  log.write("Starting up ...");

  currentGraph = "standard";

  d3.select("#clear").on('click', function() {
    return log.clear();
  });

  d3.select("#start").on("click", function(d) {
    return comm.startRak(currentGraph);
  });

  d3.selectAll(".posgraph").on("click", function(d) {
    update(this.id);
    return currentGraph = this.id;
  });

  d3.select("#direction").on("click", function(d) {
    toggle();
    return render(graph);
  });

  d3.select("#node_sep_up").on("click", function(d) {
    nodeSep += 10;
    return render(graph);
  });

  widgets = new Controller(log);

  widgets.stopServer = function(name) {
    return comm.publish(config.workX, "stop " + name, config.execQ);
  };

  messageHandler = function(m) {
    var body, topic;
    topic = m.args.routingKey;
    body = m.body.getString(Charset.UTF8);
    switch (m.args.exchange) {
      case config.signalX:
        return signalDispatcher(widgets, topic, body);
      case config.serverX:
        return serverDispatcher(widgets, topic, body);
    }
  };

  comm = new Communicator(log, messageHandler);

  comm.connect(config, config.credentials);

  update(currentGraph);

}).call(this);
